var FExif=FExif||{};(function(c){const a="https://api.flickr.com/services/rest/";const b="bd507f67af32e0216a949b98054c74cd";const f="exif";const e=function(){this._buildQuery=function(g){let queries=[];Object.keys(g).forEach(function(h){queries.push(h+"="+g[h])});if(queries.length==0){return""}return("&"+queries.join("&"))};this._fetch=function(h,g){let url=a+"?method="+h+"&api_key="+b+"&format=json&nojsoncallback=1";url+=this._buildQuery(g);return fetch(url).then(function(j){if(!j.ok||j.status!=200){return Promise.reject()}return j.json()}).then(function(j){if(j.stat=="ok"){return j}let err="Flickr fetch error: stat="+j.stat;if(j.message){err+=" ["+j.message+"]"}return Promise.reject(err)})};this.getExif=function(g){return this._fetch("flickr.photos.getExif",{photo_id:g}).then(function(h){let exif={};exif.Camera=h.photo.camera;h.photo.exif.forEach(function(j){if(!j.tag||!j.raw||!j.raw._content){return true}exif[j.tag]=j.raw._content});return exif})}};function d(g){let ifr=g.contentWindow.document;let exif_div=ifr.querySelector("div.license");if(!exif_div){return}let img=ifr.getElementsByTagName("img");if(img.length==0){return}let mc=img[0].src.match(/.+\/([^_]+)_.+$/);if(!mc||mc.length==0){return}let flickr=new e();flickr.getExif(mc[1]).then(function(h){let s_speed=h.ExposureTime;if(s_speed.indexOf("/")==-1){s_speed+="sec"}return h.Camera+", "+h.LensModel+", ISO"+h.ISO+" "+h.FocalLength+" f/"+h.FNumber+" "+s_speed}).then(function(h){exif_div.textContent=h;exif_div.classList.add("exif-info");exif_div.style.fontStyle="italic";g.classList.add(f)})}if(!c.executed){c.executed=true;let mo=new MutationObserver(function(g){g.forEach(function(h){for(let i=0;i<h.addedNodes.length;i++){let el=h.addedNodes[i];if(!el.tagName||el.tagName.toUpperCase()!="IFRAME"){continue}let cl=el.classList;if(!cl.contains("flickr-embed-frame")||cl.contains(f)){continue}d(el)}})});mo.observe(document.body,{childList:true,subtree:true});let ifrs=document.querySelectorAll("iframe.flickr-embed-frame");for(let i=0;i<ifrs.length;i++){if(ifrs[i].contains(f)){continue}d(ifrs[i])}}})(FExif);